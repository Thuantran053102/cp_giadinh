{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.calculateInitialTranslate=exports.calculateInitialScale=exports.addIndexesToImages=void 0;exports.fetchImageSize=fetchImageSize;exports.scalesAreEqual=exports.isHex=exports.hexToRgb=exports.getScale=exports.getInitialParams=exports.getImagesWithoutSize=exports.getDistance=exports.generatePanHandlers=void 0;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _reactNative=require(\"react-native\");var SCALE_EPSILON=0.01;var SCALE_MULTIPLIER=1.2;var generatePanHandlers=function generatePanHandlers(onStart,onMove,onRelease){return _reactNative.PanResponder.create({onStartShouldSetPanResponder:function onStartShouldSetPanResponder(){return true;},onStartShouldSetPanResponderCapture:function onStartShouldSetPanResponderCapture(){return true;},onMoveShouldSetPanResponder:function onMoveShouldSetPanResponder(){return true;},onMoveShouldSetPanResponderCapture:function onMoveShouldSetPanResponderCapture(){return true;},onPanResponderGrant:onStart,onPanResponderMove:onMove,onPanResponderRelease:onRelease,onPanResponderTerminate:onRelease,onPanResponderTerminationRequest:function onPanResponderTerminationRequest(){},onShouldBlockNativeResponder:function onShouldBlockNativeResponder(){return false;}});};exports.generatePanHandlers=generatePanHandlers;var getScale=function getScale(currentDistance,initialDistance){return currentDistance/initialDistance*SCALE_MULTIPLIER;};exports.getScale=getScale;var getDistance=function getDistance(touches){var _touches=(0,_slicedToArray2.default)(touches,2),a=_touches[0],b=_touches[1];if(a==null||b==null){return 0;}return Math.sqrt(Math.pow(a.pageX-b.pageX,2)+Math.pow(a.pageY-b.pageY,2));};exports.getDistance=getDistance;var calculateInitialScale=function calculateInitialScale(){var imageWidth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var imageHeight=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var _ref=arguments.length>2?arguments[2]:undefined,screenWidth=_ref.screenWidth,screenHeight=_ref.screenHeight;var screenRatio=screenHeight/screenWidth;var imageRatio=imageHeight/imageWidth;if(imageWidth>screenWidth||imageHeight>screenHeight){if(screenRatio>imageRatio){return screenWidth/imageWidth;}return screenHeight/imageHeight;}return 1;};exports.calculateInitialScale=calculateInitialScale;var calculateInitialTranslate=function calculateInitialTranslate(){var imageWidth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var imageHeight=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var _ref2=arguments.length>2?arguments[2]:undefined,screenWidth=_ref2.screenWidth,screenHeight=_ref2.screenHeight;var getTranslate=function getTranslate(axis){var imageSize=axis==='x'?imageWidth:imageHeight;var screenSize=axis==='x'?screenWidth:screenHeight;if(imageWidth>=imageHeight){return(screenSize-imageSize)/2;}return screenSize/2-imageSize/2;};return{x:getTranslate('x'),y:getTranslate('y')};};exports.calculateInitialTranslate=calculateInitialTranslate;var getInitialParams=function getInitialParams(_ref3,screenDimensions){var width=_ref3.width,height=_ref3.height;return{scale:calculateInitialScale(width,height,screenDimensions),translate:calculateInitialTranslate(width,height,screenDimensions)};};exports.getInitialParams=getInitialParams;function fetchImageSize(){var images=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return images.reduce(function(acc,image){if(image.source&&image.source.uri&&(!image.width||!image.height)){var imageSize=new Promise(function(resolve,reject){_reactNative.Image.getSize(image.source.uri,function(width,height){return resolve({width:width,height:height,index:image.index});},reject);});acc.push(imageSize);}return acc;},[]);}var shortHexRegex=/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;var fullHexRegex=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;var isHex=function isHex(color){return fullHexRegex.test(color)||shortHexRegex.test(color);};exports.isHex=isHex;var hexToRgb=function hexToRgb(hex){var input=hex.replace(shortHexRegex,function(m,r,g,b){return\"\"+r+r+g+g+b+b;});var _concat=[].concat(fullHexRegex.exec(input)),_concat2=(0,_slicedToArray2.default)(_concat,4),match=_concat2[0],r=_concat2[1],g=_concat2[2],b=_concat2[3];if(!match){return[];}return[parseInt(r,16),parseInt(g,16),parseInt(b,16)];};exports.hexToRgb=hexToRgb;var addIndexesToImages=function addIndexesToImages(images){return images.map(function(image,index){return(0,_extends2.default)({},image,{index:index});});};exports.addIndexesToImages=addIndexesToImages;var getImagesWithoutSize=function getImagesWithoutSize(images){return images.filter(function(_ref4){var width=_ref4.width,height=_ref4.height;return!width||!height;});};exports.getImagesWithoutSize=getImagesWithoutSize;var scalesAreEqual=function scalesAreEqual(scaleA,scaleB){return Math.abs(scaleA-scaleB)<SCALE_EPSILON;};exports.scalesAreEqual=scalesAreEqual;","map":{"version":3,"names":["SCALE_EPSILON","SCALE_MULTIPLIER","generatePanHandlers","onStart","onMove","onRelease","PanResponder","create","onStartShouldSetPanResponder","onStartShouldSetPanResponderCapture","onMoveShouldSetPanResponder","onMoveShouldSetPanResponderCapture","onPanResponderGrant","onPanResponderMove","onPanResponderRelease","onPanResponderTerminate","onPanResponderTerminationRequest","onShouldBlockNativeResponder","getScale","currentDistance","initialDistance","getDistance","touches","a","b","Math","sqrt","pow","pageX","pageY","calculateInitialScale","imageWidth","imageHeight","screenWidth","screenHeight","screenRatio","imageRatio","calculateInitialTranslate","getTranslate","axis","imageSize","screenSize","x","y","getInitialParams","screenDimensions","width","height","scale","translate","fetchImageSize","images","reduce","acc","image","source","uri","Promise","resolve","reject","Image","getSize","index","push","shortHexRegex","fullHexRegex","isHex","color","test","hexToRgb","hex","input","replace","m","r","g","concat","exec","match","parseInt","addIndexesToImages","map","getImagesWithoutSize","filter","scalesAreEqual","scaleA","scaleB","abs"],"sources":["D:/React_Native/SourceCode_VPM_Swine/node_modules/react-native-image-view/src/utils.js"],"sourcesContent":["// @flow\nimport {Image, PanResponder} from 'react-native';\n\nimport {\n    type EventType,\n    type GestureState,\n    type ImageType,\n    type TouchType,\n    type TranslateType,\n    type TransitionType,\n    type DimensionsType,\n    type ScreenDimensionsType,\n} from './types';\n\nconst SCALE_EPSILON = 0.01;\nconst SCALE_MULTIPLIER = 1.2;\n\nexport const generatePanHandlers = (\n    onStart: (EventType, GestureState) => *,\n    onMove: (EventType, GestureState) => *,\n    onRelease: (EventType, GestureState) => *\n): * =>\n    PanResponder.create({\n        onStartShouldSetPanResponder: (): boolean => true,\n        onStartShouldSetPanResponderCapture: (): boolean => true,\n        onMoveShouldSetPanResponder: (): boolean => true,\n        onMoveShouldSetPanResponderCapture: (): boolean => true,\n        onPanResponderGrant: onStart,\n        onPanResponderMove: onMove,\n        onPanResponderRelease: onRelease,\n        onPanResponderTerminate: onRelease,\n        onPanResponderTerminationRequest: (): void => {},\n        onShouldBlockNativeResponder: () => false,\n    });\n\nexport const getScale = (\n    currentDistance: number,\n    initialDistance: number\n): number => (currentDistance / initialDistance) * SCALE_MULTIPLIER;\n\nexport const getDistance = (touches: Array<TouchType>): number => {\n    const [a, b] = touches;\n\n    if (a == null || b == null) {\n        return 0;\n    }\n\n    return Math.sqrt(\n        Math.pow(a.pageX - b.pageX, 2) + Math.pow(a.pageY - b.pageY, 2)\n    );\n};\n\nexport const calculateInitialScale = (\n    imageWidth: number = 0,\n    imageHeight: number = 0,\n    {screenWidth, screenHeight}: ScreenDimensionsType\n): number => {\n    const screenRatio = screenHeight / screenWidth;\n    const imageRatio = imageHeight / imageWidth;\n\n    if (imageWidth > screenWidth || imageHeight > screenHeight) {\n        if (screenRatio > imageRatio) {\n            return screenWidth / imageWidth;\n        }\n\n        return screenHeight / imageHeight;\n    }\n\n    return 1;\n};\n\nexport const calculateInitialTranslate = (\n    imageWidth: number = 0,\n    imageHeight: number = 0,\n    {screenWidth, screenHeight}: ScreenDimensionsType\n): TranslateType => {\n    const getTranslate = (axis: string): number => {\n        const imageSize = axis === 'x' ? imageWidth : imageHeight;\n        const screenSize = axis === 'x' ? screenWidth : screenHeight;\n\n        if (imageWidth >= imageHeight) {\n            return (screenSize - imageSize) / 2;\n        }\n\n        return screenSize / 2 - imageSize / 2;\n    };\n\n    return {\n        x: getTranslate('x'),\n        y: getTranslate('y'),\n    };\n};\n\nexport const getInitialParams = (\n    {width, height}: DimensionsType,\n    screenDimensions: Object\n): TransitionType => ({\n    scale: calculateInitialScale(width, height, screenDimensions),\n    translate: calculateInitialTranslate(width, height, screenDimensions),\n});\n\nexport function fetchImageSize(images: Array<ImageType> = []) {\n    return images.reduce((acc, image) => {\n        if (\n            image.source &&\n            image.source.uri &&\n            (!image.width || !image.height)\n        ) {\n            const imageSize = new Promise((resolve, reject) => {\n                Image.getSize(\n                    image.source.uri,\n                    (width, height) =>\n                        resolve({\n                            width,\n                            height,\n                            index: image.index,\n                        }),\n                    reject\n                );\n            });\n\n            acc.push(imageSize);\n        }\n\n        return acc;\n    }, []);\n}\n\nconst shortHexRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\nconst fullHexRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n\nexport const isHex = (color: string): boolean =>\n    fullHexRegex.test(color) || shortHexRegex.test(color);\n\nexport const hexToRgb = (hex: string): number[] => {\n    // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n    const input = hex.replace(\n        shortHexRegex,\n        (m, r, g, b) => `${r}${r}${g}${g}${b}${b}`\n    );\n\n    const [match, r, g, b] = [].concat(fullHexRegex.exec(input));\n\n    if (!match) {\n        return [];\n    }\n\n    return [parseInt(r, 16), parseInt(g, 16), parseInt(b, 16)];\n};\n\nexport const addIndexesToImages = (images: ImageType[]): ImageType[] =>\n    images.map((image, index) => ({...image, index}));\n\nexport const getImagesWithoutSize = (images: ImageType[]) =>\n    images.filter(({width, height}) => !width || !height);\n\nexport const scalesAreEqual = (scaleA: number, scaleB: number): boolean =>\n    Math.abs(scaleA - scaleB) < SCALE_EPSILON;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}