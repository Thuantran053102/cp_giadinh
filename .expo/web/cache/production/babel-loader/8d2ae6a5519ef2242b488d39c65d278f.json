{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=useElementLayout;var _ExecutionEnvironment=require(\"fbjs/lib/ExecutionEnvironment\");var _useLayoutEffect=_interopRequireDefault(require(\"../useLayoutEffect\"));var _UIManager=_interopRequireDefault(require(\"../../exports/UIManager\"));var DOM_LAYOUT_HANDLER_NAME='__reactLayoutHandler';var didWarn=!_ExecutionEnvironment.canUseDOM;var resizeObserver=null;function getResizeObserver(){if(_ExecutionEnvironment.canUseDOM&&typeof window.ResizeObserver!=='undefined'){if(resizeObserver==null){resizeObserver=new window.ResizeObserver(function(entries){entries.forEach(function(entry){var node=entry.target;var onLayout=node[DOM_LAYOUT_HANDLER_NAME];if(typeof onLayout==='function'){_UIManager.default.measure(node,function(x,y,width,height,left,top){var event={nativeEvent:{layout:{x:x,y:y,width:width,height:height,left:left,top:top}},timeStamp:Date.now()};Object.defineProperty(event.nativeEvent,'target',{enumerable:true,get:function get(){return entry.target;}});onLayout(event);});}});});}}else if(!didWarn){if(process.env.NODE_ENV!=='production'&&process.env.NODE_ENV!=='test'){console.warn('onLayout relies on ResizeObserver which is not supported by your browser. '+'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill.');didWarn=true;}}return resizeObserver;}function useElementLayout(ref,onLayout){var observer=getResizeObserver();(0,_useLayoutEffect.default)(function(){var node=ref.current;if(node!=null){node[DOM_LAYOUT_HANDLER_NAME]=onLayout;}},[ref,onLayout]);(0,_useLayoutEffect.default)(function(){var node=ref.current;if(node!=null&&observer!=null){if(typeof node[DOM_LAYOUT_HANDLER_NAME]==='function'){observer.observe(node);}else{observer.unobserve(node);}}return function(){if(node!=null&&observer!=null){observer.unobserve(node);}};},[ref,observer]);}","map":{"version":3,"names":["DOM_LAYOUT_HANDLER_NAME","didWarn","canUseDOM","resizeObserver","getResizeObserver","window","ResizeObserver","entries","forEach","entry","node","target","onLayout","UIManager","measure","x","y","width","height","left","top","event","nativeEvent","layout","timeStamp","Date","now","Object","defineProperty","enumerable","get","process","env","NODE_ENV","console","warn","useElementLayout","ref","observer","useLayoutEffect","current","observe","unobserve"],"sources":["D:/React_Native/SourceCode_VPM_Swine/node_modules/react-native-web/src/modules/useElementLayout/index.js"],"sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type { ElementRef } from 'react';\nimport type { LayoutEvent } from '../../types';\n\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport useLayoutEffect from '../useLayoutEffect';\nimport UIManager from '../../exports/UIManager';\n\nconst DOM_LAYOUT_HANDLER_NAME = '__reactLayoutHandler';\n\nlet didWarn = !canUseDOM;\nlet resizeObserver = null;\n\nfunction getResizeObserver(): ?ResizeObserver {\n  if (canUseDOM && typeof window.ResizeObserver !== 'undefined') {\n    if (resizeObserver == null) {\n      resizeObserver = new window.ResizeObserver(function (entries) {\n        entries.forEach((entry) => {\n          const node = entry.target;\n          const onLayout = node[DOM_LAYOUT_HANDLER_NAME];\n          if (typeof onLayout === 'function') {\n            // We still need to measure the view because browsers don't yet provide\n            // border-box dimensions in the entry\n            UIManager.measure(node, (x, y, width, height, left, top) => {\n              const event: LayoutEvent = {\n                // $FlowFixMe\n                nativeEvent: {\n                  layout: { x, y, width, height, left, top }\n                },\n                timeStamp: Date.now()\n              };\n              Object.defineProperty(event.nativeEvent, 'target', {\n                enumerable: true,\n                get: () => entry.target\n              });\n              onLayout(event);\n            });\n          }\n        });\n      });\n    }\n  } else if (!didWarn) {\n    if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n      console.warn(\n        'onLayout relies on ResizeObserver which is not supported by your browser. ' +\n          'Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill.'\n      );\n      didWarn = true;\n    }\n  }\n  return resizeObserver;\n}\n\nexport default function useElementLayout(\n  ref: ElementRef<any>,\n  onLayout?: ?(e: LayoutEvent) => void\n) {\n  const observer = getResizeObserver();\n\n  useLayoutEffect(() => {\n    const node = ref.current;\n    if (node != null) {\n      node[DOM_LAYOUT_HANDLER_NAME] = onLayout;\n    }\n  }, [ref, onLayout]);\n\n  // Observing is done in a separate effect to avoid this effect running\n  // when 'onLayout' changes.\n  useLayoutEffect(() => {\n    const node = ref.current;\n    if (node != null && observer != null) {\n      if (typeof node[DOM_LAYOUT_HANDLER_NAME] === 'function') {\n        observer.observe(node);\n      } else {\n        observer.unobserve(node);\n      }\n    }\n    return () => {\n      if (node != null && observer != null) {\n        observer.unobserve(node);\n      }\n    };\n  }, [ref, observer]);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}