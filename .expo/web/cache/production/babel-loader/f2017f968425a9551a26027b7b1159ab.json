{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=springAnimation;var _base=require(\"../base\");var _InternalAnimatedValue=_interopRequireDefault(require(\"../core/InternalAnimatedValue\"));var MAX_STEPS_MS=64;function spring(clock,state,config){var lastTime=(0,_base.cond)(state.time,state.time,clock);var deltaTime=(0,_base.min)((0,_base.sub)(clock,lastTime),MAX_STEPS_MS);var c=config.damping;var m=config.mass;var k=config.stiffness;var v0=(0,_base.multiply)(-1,state.velocity);var x0=(0,_base.sub)(config.toValue,state.position);var zeta=(0,_base.divide)(c,(0,_base.multiply)(2,(0,_base.sqrt)((0,_base.multiply)(k,m))));var omega0=(0,_base.sqrt)((0,_base.divide)(k,m));var omega1=(0,_base.multiply)(omega0,(0,_base.sqrt)((0,_base.sub)(1,(0,_base.multiply)(zeta,zeta))));var t=(0,_base.divide)(deltaTime,1000);var sin1=(0,_base.sin)((0,_base.multiply)(omega1,t));var cos1=(0,_base.cos)((0,_base.multiply)(omega1,t));var underDampedEnvelope=(0,_base.exp)((0,_base.multiply)(-1,zeta,omega0,t));var underDampedFrag1=(0,_base.multiply)(underDampedEnvelope,(0,_base.add)((0,_base.multiply)(sin1,(0,_base.divide)((0,_base.add)(v0,(0,_base.multiply)(zeta,omega0,x0)),omega1)),(0,_base.multiply)(x0,cos1)));var underDampedPosition=(0,_base.sub)(config.toValue,underDampedFrag1);var underDampedVelocity=(0,_base.sub)((0,_base.multiply)(zeta,omega0,underDampedFrag1),(0,_base.multiply)(underDampedEnvelope,(0,_base.sub)((0,_base.multiply)(cos1,(0,_base.add)(v0,(0,_base.multiply)(zeta,omega0,x0))),(0,_base.multiply)(omega1,x0,sin1))));var criticallyDampedEnvelope=(0,_base.exp)((0,_base.multiply)(-1,omega0,t));var criticallyDampedPosition=(0,_base.sub)(config.toValue,(0,_base.multiply)(criticallyDampedEnvelope,(0,_base.add)(x0,(0,_base.multiply)((0,_base.add)(v0,(0,_base.multiply)(omega0,x0)),t))));var criticallyDampedVelocity=(0,_base.multiply)(criticallyDampedEnvelope,(0,_base.add)((0,_base.multiply)(v0,(0,_base.sub)((0,_base.multiply)(t,omega0),1)),(0,_base.multiply)(t,x0,omega0,omega0)));var prevPosition=state.prevPosition?state.prevPosition:new _InternalAnimatedValue.default(0);var isOvershooting=(0,_base.cond)((0,_base.and)(config.overshootClamping,(0,_base.neq)(config.stiffness,0)),(0,_base.cond)((0,_base.lessThan)(prevPosition,config.toValue),(0,_base.greaterThan)(state.position,config.toValue),(0,_base.lessThan)(state.position,config.toValue)));var isVelocity=(0,_base.lessThan)((0,_base.abs)(state.velocity),config.restSpeedThreshold);var isDisplacement=(0,_base.or)((0,_base.eq)(config.stiffness,0),(0,_base.lessThan)((0,_base.abs)((0,_base.sub)(config.toValue,state.position)),config.restDisplacementThreshold));return(0,_base.block)([(0,_base.set)(prevPosition,state.position),(0,_base.cond)((0,_base.lessThan)(zeta,1),[(0,_base.set)(state.position,underDampedPosition),(0,_base.set)(state.velocity,underDampedVelocity)],[(0,_base.set)(state.position,criticallyDampedPosition),(0,_base.set)(state.velocity,criticallyDampedVelocity)]),(0,_base.set)(state.time,clock),(0,_base.cond)((0,_base.or)(isOvershooting,(0,_base.and)(isVelocity,isDisplacement)),[(0,_base.cond)((0,_base.neq)(config.stiffness,0),[(0,_base.set)(state.velocity,0),(0,_base.set)(state.position,config.toValue)]),(0,_base.set)(state.finished,1)])]);}var procSpring=(0,_base.proc)(function(finished,velocity,position,time,prevPosition,toValue,damping,mass,stiffness,overshootClamping,restSpeedThreshold,restDisplacementThreshold,clock){return spring(clock,{finished:finished,velocity:velocity,position:position,time:time,prevPosition:prevPosition},{toValue:toValue,damping:damping,mass:mass,stiffness:stiffness,overshootClamping:overshootClamping,restDisplacementThreshold:restDisplacementThreshold,restSpeedThreshold:restSpeedThreshold});});function springAnimation(clock,_ref,_ref2){var finished=_ref.finished,velocity=_ref.velocity,position=_ref.position,time=_ref.time,prevPosition=_ref.prevPosition;var toValue=_ref2.toValue,damping=_ref2.damping,mass=_ref2.mass,stiffness=_ref2.stiffness,overshootClamping=_ref2.overshootClamping,restDisplacementThreshold=_ref2.restDisplacementThreshold,restSpeedThreshold=_ref2.restSpeedThreshold;return procSpring(finished,velocity,position,time,prevPosition,toValue,damping,mass,stiffness,overshootClamping,restSpeedThreshold,restDisplacementThreshold,clock);}","map":{"version":3,"names":["MAX_STEPS_MS","spring","clock","state","config","lastTime","cond","time","deltaTime","min","sub","c","damping","m","mass","k","stiffness","v0","multiply","velocity","x0","toValue","position","zeta","divide","sqrt","omega0","omega1","t","sin1","sin","cos1","cos","underDampedEnvelope","exp","underDampedFrag1","add","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","prevPosition","AnimatedValue","isOvershooting","and","overshootClamping","neq","lessThan","greaterThan","isVelocity","abs","restSpeedThreshold","isDisplacement","or","eq","restDisplacementThreshold","block","set","finished","procSpring","proc","springAnimation"],"sources":["D:/React_Native/SourceCode_VPM_Swine/node_modules/react-native-reanimated/lib/reanimated1/animations/spring.js"],"sourcesContent":["import {\n  cond,\n  sub,\n  divide,\n  multiply,\n  sqrt,\n  add,\n  block,\n  set,\n  exp,\n  sin,\n  cos,\n  eq,\n  or,\n  neq,\n  and,\n  lessThan,\n  greaterThan,\n  proc,\n  min,\n  abs,\n} from '../base';\nimport AnimatedValue from '../core/InternalAnimatedValue';\n\nconst MAX_STEPS_MS = 64;\n\nfunction spring(clock, state, config) {\n  const lastTime = cond(state.time, state.time, clock);\n\n  const deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n\n  const c = config.damping;\n  const m = config.mass;\n  const k = config.stiffness;\n\n  const v0 = multiply(-1, state.velocity);\n  const x0 = sub(config.toValue, state.position);\n\n  const zeta = divide(c, multiply(2, sqrt(multiply(k, m)))); // damping ratio\n  const omega0 = sqrt(divide(k, m)); // undamped angular frequency of the oscillator (rad/ms)\n  const omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta)))); // exponential decay\n\n  const t = divide(deltaTime, 1000); // in seconds\n\n  const sin1 = sin(multiply(omega1, t));\n  const cos1 = cos(multiply(omega1, t));\n\n  // under damped\n  const underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  const underDampedFrag1 = multiply(\n    underDampedEnvelope,\n    add(\n      multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)),\n      multiply(x0, cos1)\n    )\n  );\n  const underDampedPosition = sub(config.toValue, underDampedFrag1);\n  // This looks crazy -- it's actually just the derivative of the oscillation function\n  const underDampedVelocity = sub(\n    multiply(zeta, omega0, underDampedFrag1),\n    multiply(\n      underDampedEnvelope,\n      sub(\n        multiply(cos1, add(v0, multiply(zeta, omega0, x0))),\n        multiply(omega1, x0, sin1)\n      )\n    )\n  );\n\n  // critically damped\n  const criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  const criticallyDampedPosition = sub(\n    config.toValue,\n    multiply(\n      criticallyDampedEnvelope,\n      add(x0, multiply(add(v0, multiply(omega0, x0)), t))\n    )\n  );\n  const criticallyDampedVelocity = multiply(\n    criticallyDampedEnvelope,\n    add(\n      multiply(v0, sub(multiply(t, omega0), 1)),\n      multiply(t, x0, omega0, omega0)\n    )\n  );\n\n  // conditions for stopping the spring animations\n  const prevPosition = state.prevPosition\n    ? state.prevPosition\n    : new AnimatedValue(0);\n\n  const isOvershooting = cond(\n    and(config.overshootClamping, neq(config.stiffness, 0)),\n    cond(\n      lessThan(prevPosition, config.toValue),\n      greaterThan(state.position, config.toValue),\n      lessThan(state.position, config.toValue)\n    )\n  );\n  const isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  const isDisplacement = or(\n    eq(config.stiffness, 0),\n    lessThan(\n      abs(sub(config.toValue, state.position)),\n      config.restDisplacementThreshold\n    )\n  );\n\n  return block([\n    set(prevPosition, state.position),\n    cond(\n      lessThan(zeta, 1),\n      [\n        set(state.position, underDampedPosition),\n        set(state.velocity, underDampedVelocity),\n      ],\n      [\n        set(state.position, criticallyDampedPosition),\n        set(state.velocity, criticallyDampedVelocity),\n      ]\n    ),\n    set(state.time, clock),\n    cond(or(isOvershooting, and(isVelocity, isDisplacement)), [\n      cond(neq(config.stiffness, 0), [\n        set(state.velocity, 0),\n        set(state.position, config.toValue),\n      ]),\n      set(state.finished, 1),\n    ]),\n  ]);\n}\n\nconst procSpring = proc(\n  (\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  ) =>\n    spring(\n      clock,\n      {\n        finished,\n        velocity,\n        position,\n        time,\n        prevPosition,\n      },\n      {\n        toValue,\n        damping,\n        mass,\n        stiffness,\n        overshootClamping,\n        restDisplacementThreshold,\n        restSpeedThreshold,\n      }\n    )\n);\n\nexport default function springAnimation(\n  clock,\n  { finished, velocity, position, time, prevPosition },\n  {\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restDisplacementThreshold,\n    restSpeedThreshold,\n  }\n) {\n  return procSpring(\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}