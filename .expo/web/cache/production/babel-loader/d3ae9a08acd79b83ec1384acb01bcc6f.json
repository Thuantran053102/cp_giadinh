{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.NOTIFICATIONS=exports.MOTION=exports.MEDIA_LIBRARY_WRITE_ONLY=exports.MEDIA_LIBRARY=exports.LOCATION_FOREGROUND=exports.LOCATION_BACKGROUND=exports.LOCATION=exports.CONTACTS=exports.CAMERA_ROLL=exports.CAMERA=exports.CALENDAR=exports.AUDIO_RECORDING=void 0;Object.defineProperty(exports,\"PermissionStatus\",{enumerable:true,get:function get(){return _Permissions.PermissionStatus;}});exports.USER_FACING_NOTIFICATIONS=exports.SYSTEM_BRIGHTNESS=exports.REMINDERS=void 0;exports.askAsync=askAsync;exports.getAsync=getAsync;var _regenerator=_interopRequireDefault(require(\"@babel/runtime/regenerator\"));var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _defineProperty2=_interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));var _reactNative=require(\"react-native\");var _CoalescedPermissions=require(\"./CoalescedPermissions\");var _ExpoPermissions=_interopRequireDefault(require(\"./ExpoPermissions\"));var _Permissions=require(\"./Permissions.types\");var _PERMISSION_MODULE_MA;function _createForOfIteratorHelperLoose(o,allowArrayLike){var it=typeof Symbol!==\"undefined\"&&o[Symbol.iterator]||o[\"@@iterator\"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length===\"number\"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(o);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}var CAMERA='camera';exports.CAMERA=CAMERA;var MEDIA_LIBRARY='mediaLibrary';exports.MEDIA_LIBRARY=MEDIA_LIBRARY;var MEDIA_LIBRARY_WRITE_ONLY='mediaLibraryWriteOnly';exports.MEDIA_LIBRARY_WRITE_ONLY=MEDIA_LIBRARY_WRITE_ONLY;var CAMERA_ROLL=MEDIA_LIBRARY;exports.CAMERA_ROLL=CAMERA_ROLL;var AUDIO_RECORDING='audioRecording';exports.AUDIO_RECORDING=AUDIO_RECORDING;var LOCATION='location';exports.LOCATION=LOCATION;var LOCATION_FOREGROUND='locationForeground';exports.LOCATION_FOREGROUND=LOCATION_FOREGROUND;var LOCATION_BACKGROUND='locationBackground';exports.LOCATION_BACKGROUND=LOCATION_BACKGROUND;var USER_FACING_NOTIFICATIONS='userFacingNotifications';exports.USER_FACING_NOTIFICATIONS=USER_FACING_NOTIFICATIONS;var NOTIFICATIONS='notifications';exports.NOTIFICATIONS=NOTIFICATIONS;var CONTACTS='contacts';exports.CONTACTS=CONTACTS;var CALENDAR='calendar';exports.CALENDAR=CALENDAR;var REMINDERS='reminders';exports.REMINDERS=REMINDERS;var SYSTEM_BRIGHTNESS='systemBrightness';exports.SYSTEM_BRIGHTNESS=SYSTEM_BRIGHTNESS;var MOTION='motion';exports.MOTION=MOTION;var PERMISSION_MODULE_MAPPING=(_PERMISSION_MODULE_MA={},(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,CAMERA,'expo-camera'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,CAMERA_ROLL,'expo-media-library'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,MEDIA_LIBRARY,'expo-media-library'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,MEDIA_LIBRARY_WRITE_ONLY,'expo-media-library'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,AUDIO_RECORDING,'expo-av'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,LOCATION,'expo-location'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,USER_FACING_NOTIFICATIONS,'expo-notifications'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,NOTIFICATIONS,'expo-notifications'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,CONTACTS,'expo-contacts'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,CALENDAR,'expo-calendar'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,REMINDERS,'expo-calendar'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,SYSTEM_BRIGHTNESS,'expo-brightness'),(0,_defineProperty2.default)(_PERMISSION_MODULE_MA,MOTION,'expo-sensors'),_PERMISSION_MODULE_MA);function getAsync(){var _len,types,_key,_args=arguments;return _regenerator.default.async(function getAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:console.warn(\"expo-permissions is now deprecated \\u2014 the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.\");for(_len=_args.length,types=new Array(_len),_key=0;_key<_len;_key++){types[_key]=_args[_key];}if(!(_reactNative.Platform.OS==='ios')){_context.next=6;break;}_context.next=5;return _regenerator.default.awrap(_handleMultiPermissionsRequestIOSAsync(types,_ExpoPermissions.default.getAsync));case 5:return _context.abrupt(\"return\",_context.sent);case 6:_context.next=8;return _regenerator.default.awrap(_handlePermissionsRequestAsync(types,_ExpoPermissions.default.getAsync));case 8:return _context.abrupt(\"return\",_context.sent);case 9:case\"end\":return _context.stop();}}},null,null,null,Promise);}function askAsync(){var _len2,types,_key2,_args2=arguments;return _regenerator.default.async(function askAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.warn(\"expo-permissions is now deprecated \\u2014 the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.\");for(_len2=_args2.length,types=new Array(_len2),_key2=0;_key2<_len2;_key2++){types[_key2]=_args2[_key2];}if(!(_reactNative.Platform.OS==='ios')){_context2.next=6;break;}_context2.next=5;return _regenerator.default.awrap(_handleMultiPermissionsRequestIOSAsync(types,_ExpoPermissions.default.askAsync));case 5:return _context2.abrupt(\"return\",_context2.sent);case 6:_context2.next=8;return _regenerator.default.awrap(_handlePermissionsRequestAsync(types,_ExpoPermissions.default.askAsync));case 8:return _context2.abrupt(\"return\",_context2.sent);case 9:case\"end\":return _context2.stop();}}},null,null,null,Promise);}function _handleSinglePermissionRequestIOSAsync(type,handlePermission){var library;return _regenerator.default.async(function _handleSinglePermissionRequestIOSAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(_reactNative.Platform.OS!=='web'&&type==='motion')){_context3.next=2;break;}return _context3.abrupt(\"return\",{status:_Permissions.PermissionStatus.GRANTED,expires:'never',granted:true,canAskAgain:true});case 2:_context3.prev=2;_context3.next=5;return _regenerator.default.awrap(handlePermission(type));case 5:return _context3.abrupt(\"return\",_context3.sent);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](2);if(_context3.t0.code==='E_PERMISSIONS_UNKNOWN'&&PERMISSION_MODULE_MAPPING[type]){library=PERMISSION_MODULE_MAPPING[type];_context3.t0.message=_context3.t0.message+\", please install and link the package \"+PERMISSION_MODULE_MAPPING[type]+\", see more at https://github.com/expo/expo/tree/master/packages/\"+library;}throw _context3.t0;case 12:case\"end\":return _context3.stop();}}},null,null,[[2,8]],Promise);}function _handleMultiPermissionsRequestIOSAsync(types,handlePermission){var permissions,_iterator,_step,type;return _regenerator.default.async(function _handleMultiPermissionsRequestIOSAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(types.length){_context4.next=2;break;}throw new Error('At least one permission type must be specified');case 2:permissions={};_iterator=_createForOfIteratorHelperLoose(types);case 4:if((_step=_iterator()).done){_context4.next=11;break;}type=_step.value;_context4.next=8;return _regenerator.default.awrap(_handleSinglePermissionRequestIOSAsync(type,handlePermission));case 8:permissions[type]=_context4.sent;case 9:_context4.next=4;break;case 11:return _context4.abrupt(\"return\",{status:(0,_CoalescedPermissions.coalesceStatuses)(permissions),expires:(0,_CoalescedPermissions.coalesceExpirations)(permissions),canAskAgain:(0,_CoalescedPermissions.coalesceCanAskAgain)(permissions),granted:(0,_CoalescedPermissions.coalesceGranted)(permissions),permissions:permissions});case 12:case\"end\":return _context4.stop();}}},null,null,null,Promise);}function _handlePermissionsRequestAsync(types,handlePermissions){var approvedPermission,permissions;return _regenerator.default.async(function _handlePermissionsRequestAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(types.length){_context5.next=2;break;}throw new Error('At least one permission type must be specified');case 2:if(!(_reactNative.Platform.OS!=='web'&&types.length===1&&types[0]==='motion')){_context5.next=5;break;}approvedPermission={status:_Permissions.PermissionStatus.GRANTED,expires:'never',granted:true,canAskAgain:true};return _context5.abrupt(\"return\",(0,_extends2.default)({},approvedPermission,{permissions:{motion:approvedPermission}}));case 5:_context5.next=7;return _regenerator.default.awrap(handlePermissions(types));case 7:permissions=_context5.sent;return _context5.abrupt(\"return\",{status:(0,_CoalescedPermissions.coalesceStatuses)(permissions),expires:(0,_CoalescedPermissions.coalesceExpirations)(permissions),canAskAgain:(0,_CoalescedPermissions.coalesceCanAskAgain)(permissions),granted:(0,_CoalescedPermissions.coalesceGranted)(permissions),permissions:permissions});case 9:case\"end\":return _context5.stop();}}},null,null,null,Promise);}","map":{"version":3,"sources":["../src/Permissions.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform } from 'react-native';\n\nimport {\n  coalesceExpirations,\n  coalesceStatuses,\n  coalesceCanAskAgain,\n  coalesceGranted,\n} from './CoalescedPermissions';\nimport Permissions from './ExpoPermissions';\nimport {\n  PermissionResponse,\n  PermissionType,\n  PermissionMap,\n  PermissionStatus,\n  PermissionExpiration,\n  PermissionInfo,\n} from './Permissions.types';\n\nexport {\n  PermissionStatus,\n  PermissionResponse,\n  PermissionExpiration,\n  PermissionMap,\n  PermissionInfo,\n  PermissionType,\n};\n\nexport const CAMERA = 'camera';\nexport const MEDIA_LIBRARY = 'mediaLibrary';\nexport const MEDIA_LIBRARY_WRITE_ONLY = 'mediaLibraryWriteOnly';\n/**\n * @deprecated Use `MEDIA_LIBRARY` or `MEDIA_LIBRARY_WRITE_ONLY`\n */\nexport const CAMERA_ROLL = MEDIA_LIBRARY;\nexport const AUDIO_RECORDING = 'audioRecording';\n/** @deprecated Use `LOCATION_FOREGROUND` or `LOCATION_BACKGROUND` instead */\nexport const LOCATION = 'location';\nexport const LOCATION_FOREGROUND = 'locationForeground';\nexport const LOCATION_BACKGROUND = 'locationBackground';\nexport const USER_FACING_NOTIFICATIONS = 'userFacingNotifications';\nexport const NOTIFICATIONS = 'notifications';\nexport const CONTACTS = 'contacts';\nexport const CALENDAR = 'calendar';\nexport const REMINDERS = 'reminders';\nexport const SYSTEM_BRIGHTNESS = 'systemBrightness';\nexport const MOTION = 'motion';\n\n// Map corresponding permission to correct package\nconst PERMISSION_MODULE_MAPPING = {\n  [CAMERA]: 'expo-camera',\n  [CAMERA_ROLL]: 'expo-media-library',\n  [MEDIA_LIBRARY]: 'expo-media-library',\n  [MEDIA_LIBRARY_WRITE_ONLY]: 'expo-media-library',\n  [AUDIO_RECORDING]: 'expo-av',\n  [LOCATION]: 'expo-location',\n  [USER_FACING_NOTIFICATIONS]: 'expo-notifications',\n  [NOTIFICATIONS]: 'expo-notifications',\n  [CONTACTS]: 'expo-contacts',\n  [CALENDAR]: 'expo-calendar',\n  [REMINDERS]: 'expo-calendar',\n  [SYSTEM_BRIGHTNESS]: 'expo-brightness',\n  [MOTION]: 'expo-sensors',\n};\n\nexport async function getAsync(...types: PermissionType[]): Promise<PermissionResponse> {\n  console.warn(\n    `expo-permissions is now deprecated — the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.`\n  );\n\n  if (Platform.OS === 'ios') {\n    return await _handleMultiPermissionsRequestIOSAsync(types, Permissions.getAsync);\n  }\n  return await _handlePermissionsRequestAsync(types, Permissions.getAsync);\n}\n\nexport async function askAsync(...types: PermissionType[]): Promise<PermissionResponse> {\n  console.warn(\n    `expo-permissions is now deprecated — the functionality has been moved to other expo packages that directly use these permissions (e.g. expo-location, expo-camera). The package will be removed in the upcoming releases.`\n  );\n\n  if (Platform.OS === 'ios') {\n    return await _handleMultiPermissionsRequestIOSAsync(types, Permissions.askAsync);\n  }\n  return await _handlePermissionsRequestAsync(types, Permissions.askAsync);\n}\n\nasync function _handleSinglePermissionRequestIOSAsync(\n  type: PermissionType,\n  handlePermission: (type: PermissionType) => Promise<PermissionInfo>\n): Promise<PermissionInfo> {\n  if (Platform.OS !== 'web' && type === 'motion') {\n    return {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      granted: true,\n      canAskAgain: true,\n    };\n  }\n  try {\n    return await handlePermission(type);\n  } catch (error) {\n    // We recognize the permission's library, so we inform the user to link that library to request the permission.\n    if (error.code === 'E_PERMISSIONS_UNKNOWN' && PERMISSION_MODULE_MAPPING[type]) {\n      const library = PERMISSION_MODULE_MAPPING[type];\n      error.message = `${error.message}, please install and link the package ${PERMISSION_MODULE_MAPPING[type]}, see more at https://github.com/expo/expo/tree/master/packages/${library}`;\n    }\n    throw error;\n  }\n}\n\nasync function _handleMultiPermissionsRequestIOSAsync(\n  types: PermissionType[],\n  handlePermission: (type: PermissionType) => Promise<PermissionInfo>\n): Promise<PermissionResponse> {\n  if (!types.length) {\n    throw new Error('At least one permission type must be specified');\n  }\n\n  const permissions = {};\n  for (const type of types) {\n    permissions[type] = await _handleSinglePermissionRequestIOSAsync(type, handlePermission);\n  }\n\n  return {\n    status: coalesceStatuses(permissions),\n    expires: coalesceExpirations(permissions),\n    canAskAgain: coalesceCanAskAgain(permissions),\n    granted: coalesceGranted(permissions),\n    permissions,\n  };\n}\n\nasync function _handlePermissionsRequestAsync(\n  types: PermissionType[],\n  handlePermissions: (types: PermissionType[]) => Promise<PermissionMap>\n): Promise<PermissionResponse> {\n  if (!types.length) {\n    throw new Error('At least one permission type must be specified');\n  }\n\n  if (Platform.OS !== 'web' && types.length === 1 && types[0] === 'motion') {\n    const approvedPermission = {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      granted: true,\n      canAskAgain: true,\n    };\n    return {\n      ...approvedPermission,\n      // @ts-ignore\n      permissions: { motion: approvedPermission },\n    };\n  }\n\n  const permissions = await handlePermissions(types);\n  return {\n    status: coalesceStatuses(permissions),\n    expires: coalesceExpirations(permissions),\n    canAskAgain: coalesceCanAskAgain(permissions),\n    granted: coalesceGranted(permissions),\n    permissions,\n  };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}